# Kitbash Phase 3B Configuration
# This file provides defaults and is overridden by environment variables.
# For Docker: use .env and docker-compose.yml instead.

redis:
  host: localhost
  port: 6379
  db: 0
  password: null
  connection_timeout: 5
  socket_timeout: 5
  retry_on_timeout: true

kitbash:
  environment: development
  log_level: INFO
  debug_mode: false

# Layer Configuration - Timeouts in milliseconds
layers:
  layer0:
    name: "Grain Reflex"
    timeout_ms: 10
    enabled: true
    description: "O(1) grain lookup from 261 crystallized facts"

  layer1:
    name: "BitNet Pattern Matching"
    timeout_ms: 10
    enabled: true
    description: "Fast keyword and pattern matching"

  layer2:
    name: "Hot Cartridge"
    timeout_ms: 100
    enabled: true
    description: "Indexed fact lookup and retrieval"

  layer3:
    name: "Cold Cartridge + SmolML"
    timeout_ms: 500
    enabled: true
    description: "Synthesis and fact composition"

  layer4:
    name: "Full LLM (KoboldCpp)"
    timeout_ms: 2000
    enabled: false
    description: "Deep reasoning and complex problem solving"

# Subprocess Worker Configuration
workers:
  bitnet:
    host: localhost
    port: 5001
    enabled: true
    retry_attempts: 3
    retry_backoff_ms: 100

  cartridge:
    host: localhost
    port: 5002
    enabled: true
    retry_attempts: 3
    retry_backoff_ms: 100

  kobold:
    host: localhost
    port: 5003
    enabled: false
    retry_attempts: 3
    retry_backoff_ms: 100

# Diagnostic & Monitoring
diagnostics:
  redis_enabled: true
  log_retention_days: 7
  metric_collection: true
  health_check_interval_ms: 5000
  event_buffer_size: 1000

# Performance Tuning
performance:
  grain_cache_size: 1000
  cartridge_cache_size: 100
  consensus_confidence_threshold: 0.85
  escalation_confidence_threshold: 0.60
  query_parallelization: false  # Will be true in Phase 3C

# Redis Key Namespace
redis_keys:
  prefix: "kitbash:"
  grain_index: "kitbash:grains"
  query_queue: "kitbash:queries:queue"
  query_state: "kitbash:queries:state:"
  diagnostic_feed: "kitbash:diagnostic:feed"
  health_status: "kitbash:health:"
  metrics: "kitbash:metrics:"
